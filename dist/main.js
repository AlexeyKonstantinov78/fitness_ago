(()=>{"use strict";const e=(e,t)=>{const l=document.createElement("div");return fetch(`./${e}.html`).then((e=>{if(200!==e.status)throw new Error("sts]atus network not 200");return e.text()})).then((e=>(l.innerHTML=e,(e=>{const l=e.querySelectorAll("input"),r=e.querySelectorAll("label");let o;return l.forEach(((e,l)=>{"d"!==e.value.trim().substring(e.value.trim().length-1,e.value.trim().length)&&e.value.trim().substring(0,e.value.trim().length-1)===t&&(o=+r[l].querySelector(".cost").firstChild.textContent)})),o})(l.querySelector("#card_order>.cards-types"))))).catch((e=>console.error(e)))};(()=>{const e=document.querySelector(".clubs-list>ul");document.querySelector(".header-main").addEventListener("click",(t=>{t.target.closest(".club-select")?e.style.cssText?e.style.display="":e.style.display="inline":e.style.display=""}))})(),(()=>{const e=document.querySelector(".header-main"),t=document.querySelector(".fixed-gift"),l=e=>{const t=document.querySelector(e);t.style.display="inline",t.addEventListener("click",(e=>{(e.target.closest(".close-form")||e.target.closest(".overlay")||e.target.closest(".close-btn"))&&(t.style.display="")}))};e.addEventListener("click",(e=>{const t=e.target;t.closest(".open-popup")&&l(t.dataset.popup),t.closest(".callback-btn")&&l(t.dataset.popup)}));try{t.addEventListener("click",(()=>{l("#gift"),t.style.display="none"}))}catch(e){console.error("нет подарка")}})(),(()=>{const e=document.getElementById("totop"),t=document.querySelector(".top-menu");e.style.display="none",window.addEventListener("scroll",(()=>{pageYOffset>181&&innerWidth<768?t.style.position="fixed":t.style.position="",pageYOffset<740?e.style.display="none":e.style.display=""}))})(),(()=>{const e=document.querySelectorAll(".main-slider>.slide"),t=l=>{e[l].style.display="none",l!==e.length-1?(l++,e[l].style.display=""):e[l=0].style.display="",setTimeout((()=>{t(l)}),3e3)};e.forEach(((e,l)=>{""!==e.style.display||setTimeout((()=>{t(l)}),3e3)}))})(),(()=>{const e=document.querySelectorAll(".gallery-slider>.slide"),t=document.querySelector(".gallery-slider");let l,r=document.querySelectorAll(".dot"),o=0;const s=(e,t,l)=>{e[t].classList.remove(l)},n=(e,t,l)=>{e[t].classList.add(l)},c=()=>{s(e,o,"slide-active"),s(r,o,"dot-active"),o++,o>=e.length&&(o=0),n(e,o,"slide-active"),n(r,o,"dot-active")},a=(e=2e3)=>{l=setInterval(c,e)};t.addEventListener("click",(t=>{t.preventDefault();let l=t.target;l.matches(".slider-arrow, .dot")&&(s(e,o,"slide-active"),s(r,o,"dot-active"),l.matches("#arrow-right")?o++:l.matches("#arrow-left")?o--:l.matches(".dot")&&r.forEach(((e,t)=>{e===l&&(o=t)})),o>=e.length&&(o=0),o<0&&(o=e.length-1),n(e,o,"slide-active"),n(r,o,"dot-active"))})),t.addEventListener("mouseover",(e=>{e.target.matches(".slider-arrow, .dot")&&clearInterval(l)})),t.addEventListener("mouseout",(e=>{e.target.matches(".slider-arrow, .dot")&&a()})),a(2e3)})(),(()=>{const e=document.querySelector(".services-slider"),t=document.querySelector(".carusel-slider");let l=0;t.addEventListener("click",(t=>{t.target.closest(".slider-arrow.prev")&&(0===l&&(l=100),l+=-20,e.style.transform=`translateX(-${l}%)`),t.target.closest(".slider-arrow.next")&&(100===l&&(l=0),l+=20,e.style.transform=`translateX(-${l}%)`)}))})(),(()=>{try{const t=document.querySelector("#card_order"),l=document.querySelectorAll("#card_order>.club>input"),r=document.querySelectorAll("#card_order>.time>input"),o=document.querySelector("#card_order>.price>.input-text>input"),s=document.querySelector("#card_order>.price>#price-total");let n={};const c=()=>{l.forEach((t=>{t.checked&&r.forEach((l=>{l.checked&&(n=e(t.value,l.value))}))})),n.then((e=>{s.textContent=e,"ТЕЛО2020"===o.value.trim()&&(s.textContent=Math.floor(.7*e))}))};t.addEventListener("input",(e=>{const t=e.target;t.closest(".club")&&c(),t.closest(".time")&&c(),t.closest(".price-message.input-text")&&c()})),c()}catch(e){console.error("не работает на этой странице")}})(),(()=>{const e=document.querySelector("header"),t=document.querySelector(".popup-menu.hidden-large");e.addEventListener("click",(e=>{const l=e.target;l.closest(".menu-button.hidden-large>img")&&(t.style.display="flex"),l.closest(".close-menu-btn>img")&&(t.style.display=""),l.closest(".popup-menu.hidden-large>ul>li")&&(t.style.display="")}))})(),(()=>{const e=document.querySelectorAll("form"),t=document.createElement("div");t.style.cssText="font-size: 2rem; color: #aa8800;background-color: #ffd11a;text-align: center;",e.forEach((e=>{e.addEventListener("input",(t=>s(t.target,e))),e.closest("#footer_form")||e.querySelector(".btn").addEventListener("click",(()=>{e.querySelector(".personal-data>input").checked||(e.appendChild(t),t.textContent="Вы должны дать согласие перед отправкой",n(e))})),e.addEventListener("submit",(r=>{r.preventDefault(),e.appendChild(t),t.textContent="Идет отправка...";const s=new FormData(e);let a={};s.forEach(((e,t)=>{a[t]=e})),l(a,e)?fetch("./server.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then((l=>{if(200!==l.status)throw new Error("status network not 200");t.textContent="",o(!0),n(e)})).catch((t=>{o(!1),n(e),console.error(t)})).finally((()=>{c(e)})):(t.textContent="Что то не так...",n(e))}))}));const l=(e,t)=>{try{if(e.name.length<=3&&void 0!==e.name)return!1}catch(e){console.log("параметра name В ЭТОЙ ФОРМЕ нет")}return!(t.closest("#footer_form")&&!r(t)||e.phone.length<=7||!/^\+?[7|8]([-()]*\d){7,10}$/.test(e.phone))},r=e=>{let t=!1;return e.querySelectorAll(".club>input").forEach((e=>{if(!0===e.checked)return console.log("true"),void(t=!0)})),t},o=e=>{const t=document.querySelector("#thanks"),l=document.querySelector("#thanks>.form-wrapper"),r=document.createElement("div"),o=document.querySelector("#callback_form"),s=document.querySelector("#free_visit_form");r.classList.add("form-content"),r.innerHTML=e?'<h4>Спасибо!</h4>\n            <p>Ваша заявка отправлена. <br> Мы свяжемся с вами в ближайшее время.</p>\n            <button class="btn close-btn">OK</button>':'<h4>Извините!</h4>\n            <p>Что то пошло не так...</p>\n            <button class="btn close-btn">OK</button>',l.appendChild(r),t.style.display="inline",t.addEventListener("click",(e=>{const t=e.target;(t.closest(".close-form")||t.closest(".btn.close-btn")||t.closest(".overlay"))&&n(),"inline"===o.style.display&&(o.style.display=""),"inline"===s.style.display&&(s.style.display="")}));const n=()=>{const e=document.querySelector("#thanks>.form-wrapper>.form-content");t.style.display="",null!==e&&e.remove(),"inline"===o.style.display&&(o.style.display=""),"inline"===s.style.display&&(s.style.display="")};setTimeout((()=>n()),5e3)},s=(e,t)=>{e.closest(".form-phone")&&(e.value=e.value.substring(0,12).replace(/[^\+0-9]/g,"")+e.value.substring(11).replace(/./g,""),/^\+?[7|8]([-()]*\d){7,10}$/.test(e.value)&&e.value.length>=8&&e.value.length<=12?e.style.border="":e.style.border="solid red"),(e.closest(".form-name")||e.closest("#form2-name"))&&(e.value=e.value.replace(/[^А-Яа-яЁё ]/gi,""))},n=e=>{setTimeout((()=>{null!==t&&t.remove()}),5e3)},c=e=>{e.querySelectorAll("input").forEach((e=>{e.value=""}))}})()})();